{"version":3,"file":"workgroup_size.spec.js","names":["description","makeTestGroup","keysOf","ShaderValidationTest","g","kWorkgroupSizeTests","x_only_float","src","pass","xy_only_float","xyz_float","empty","empty_x","empty_y","invalid_entry","x_only_abstract","xy_only_abstract","xyz_abstract","x_only_unsigned","xy_only_unsigned","xyz_unsigned","x_only_signed","xy_only_signed","xyz_signed","const_expr","override","override_no_default","trailing_comma_x","trailing_comma_y","trailing_comma_z","override_expr","mixed_abstract_signed","mixed_abstract_unsigned","mixed_signed_unsigned","zero_x","zero_y","zero_z","negative_x","negative_y","negative_z","max_values","test","desc","params","u","combine","fn","t","code","attr","expectCompileResult"],"sources":["../../../../../src/webgpu/shader/validation/shader_io/workgroup_size.spec.ts"],"sourcesContent":["export const description = `Validation tests for workgroup_size`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { keysOf } from '../../../../common/util/data_tables.js';\nimport { ShaderValidationTest } from '../shader_validation_test.js';\n\nexport const g = makeTestGroup(ShaderValidationTest);\n\nconst kWorkgroupSizeTests = {\n  x_only_float: {\n    src: `@workgroup_size(8f)`,\n    pass: false,\n  },\n  xy_only_float: {\n    src: `@workgroup_size(8, 8f)`,\n    pass: false,\n  },\n  xyz_float: {\n    src: `@workgroup_size(8, 8, 8f)`,\n    pass: false,\n  },\n  empty: {\n    src: `@workgroup_size()`,\n    pass: false,\n  },\n  empty_x: {\n    src: `@workgroup_size(, 8)`,\n    pass: false,\n  },\n  empty_y: {\n    src: `@workgroup_size(8, , 8)`,\n    pass: false,\n  },\n  invalid_entry: {\n    src: `@workgroup_size(let)`,\n    pass: false,\n  },\n\n  x_only_abstract: {\n    src: `@workgroup_size(8)`,\n    pass: true,\n  },\n  xy_only_abstract: {\n    src: `@workgroup_size(8, 8)`,\n    pass: true,\n  },\n  xyz_abstract: {\n    src: `@workgroup_size(8, 8, 8)`,\n    pass: true,\n  },\n  x_only_unsigned: {\n    src: `@workgroup_size(8u)`,\n    pass: true,\n  },\n  xy_only_unsigned: {\n    src: `@workgroup_size(8u, 8u)`,\n    pass: true,\n  },\n  xyz_unsigned: {\n    src: `@workgroup_size(8u, 8u, 8u)`,\n    pass: true,\n  },\n  x_only_signed: {\n    src: `@workgroup_size(8i)`,\n    pass: true,\n  },\n  xy_only_signed: {\n    src: `@workgroup_size(8i, 8i)`,\n    pass: true,\n  },\n  xyz_signed: {\n    src: `@workgroup_size(8i, 8i, 8i)`,\n    pass: true,\n  },\n\n  const_expr: {\n    src: `const a = 4;\n    const b = 5;\n    @workgroup_size(a, b, a + b)`,\n    pass: true,\n  },\n\n  override: {\n    src: `@id(42) override block_width = 12u;\n@workgroup_size(block_width)`,\n    pass: true,\n  },\n  override_no_default: {\n    src: `override block_width: i32;\n@workgroup_size(block_width)`,\n    pass: true,\n  },\n\n  trailing_comma_x: {\n    src: `@workgroup_size(8, )`,\n    pass: true,\n  },\n  trailing_comma_y: {\n    src: `@workgroup_size(8, 8,)`,\n    pass: true,\n  },\n  trailing_comma_z: {\n    src: `@workgroup_size(8, 8, 8,)`,\n    pass: true,\n  },\n\n  override_expr: {\n    src: `override a = 5;\n    override b = 6;\n    @workgroup_size(a, b, a + b)`,\n    pass: true,\n  },\n\n  // Mixed abstract is ok\n  mixed_abstract_signed: {\n    src: `@workgroup_size(8, 8i)`,\n    pass: true,\n  },\n  mixed_abstract_unsigned: {\n    src: `@workgroup_size(8u, 8)`,\n    pass: true,\n  },\n  // Mixed signed and unsigned is not\n  mixed_signed_unsigned: {\n    src: `@workgroup_size(8i, 8i, 8u)`,\n    pass: false,\n  },\n\n  zero_x: {\n    src: `@workgroup_size(0)`,\n    pass: false,\n  },\n  zero_y: {\n    src: `@workgroup_size(8, 0)`,\n    pass: false,\n  },\n  zero_z: {\n    src: `@workgroup_size(8, 8, 0)`,\n    pass: false,\n  },\n  negative_x: {\n    src: `@workgroup_size(-8)`,\n    pass: false,\n  },\n  negative_y: {\n    src: `@workgroup_size(8, -8)`,\n    pass: false,\n  },\n  negative_z: {\n    src: `@workgroup_size(8, 8, -8)`,\n    pass: false,\n  },\n\n  max_values: {\n    src: `@workgroup_size(256, 256, 64)`,\n    pass: true,\n  },\n};\ng.test('workgroup_size')\n  .desc(`Test validation of workgroup_size`)\n  .params(u => u.combine('attr', keysOf(kWorkgroupSizeTests)))\n  .fn(t => {\n    const code = `\n${kWorkgroupSizeTests[t.params.attr].src}\n@compute fn main() {}`;\n    t.expectCompileResult(kWorkgroupSizeTests[t.params.attr].pass, code);\n  });\n"],"mappings":";AAAA;AAAA,GAAA,OAAO,MAAMA,WAAW,GAAI,qCAAoC,CAEhE,SAASC,aAAa,QAAQ,4CAA4C;AAC1E,SAASC,MAAM,QAAQ,wCAAwC;AAC/D,SAASC,oBAAoB,QAAQ,8BAA8B;;AAEnE,OAAO,MAAMC,CAAC,GAAGH,aAAa,CAACE,oBAAoB,CAAC;;AAEpD,MAAME,mBAAmB,GAAG;EAC1BC,YAAY,EAAE;IACZC,GAAG,EAAG,qBAAoB;IAC1BC,IAAI,EAAE;EACR,CAAC;EACDC,aAAa,EAAE;IACbF,GAAG,EAAG,wBAAuB;IAC7BC,IAAI,EAAE;EACR,CAAC;EACDE,SAAS,EAAE;IACTH,GAAG,EAAG,2BAA0B;IAChCC,IAAI,EAAE;EACR,CAAC;EACDG,KAAK,EAAE;IACLJ,GAAG,EAAG,mBAAkB;IACxBC,IAAI,EAAE;EACR,CAAC;EACDI,OAAO,EAAE;IACPL,GAAG,EAAG,sBAAqB;IAC3BC,IAAI,EAAE;EACR,CAAC;EACDK,OAAO,EAAE;IACPN,GAAG,EAAG,yBAAwB;IAC9BC,IAAI,EAAE;EACR,CAAC;EACDM,aAAa,EAAE;IACbP,GAAG,EAAG,sBAAqB;IAC3BC,IAAI,EAAE;EACR,CAAC;;EAEDO,eAAe,EAAE;IACfR,GAAG,EAAG,oBAAmB;IACzBC,IAAI,EAAE;EACR,CAAC;EACDQ,gBAAgB,EAAE;IAChBT,GAAG,EAAG,uBAAsB;IAC5BC,IAAI,EAAE;EACR,CAAC;EACDS,YAAY,EAAE;IACZV,GAAG,EAAG,0BAAyB;IAC/BC,IAAI,EAAE;EACR,CAAC;EACDU,eAAe,EAAE;IACfX,GAAG,EAAG,qBAAoB;IAC1BC,IAAI,EAAE;EACR,CAAC;EACDW,gBAAgB,EAAE;IAChBZ,GAAG,EAAG,yBAAwB;IAC9BC,IAAI,EAAE;EACR,CAAC;EACDY,YAAY,EAAE;IACZb,GAAG,EAAG,6BAA4B;IAClCC,IAAI,EAAE;EACR,CAAC;EACDa,aAAa,EAAE;IACbd,GAAG,EAAG,qBAAoB;IAC1BC,IAAI,EAAE;EACR,CAAC;EACDc,cAAc,EAAE;IACdf,GAAG,EAAG,yBAAwB;IAC9BC,IAAI,EAAE;EACR,CAAC;EACDe,UAAU,EAAE;IACVhB,GAAG,EAAG,6BAA4B;IAClCC,IAAI,EAAE;EACR,CAAC;;EAEDgB,UAAU,EAAE;IACVjB,GAAG,EAAG;AACV;AACA,iCAAiC;IAC7BC,IAAI,EAAE;EACR,CAAC;;EAEDiB,QAAQ,EAAE;IACRlB,GAAG,EAAG;AACV,6BAA6B;IACzBC,IAAI,EAAE;EACR,CAAC;EACDkB,mBAAmB,EAAE;IACnBnB,GAAG,EAAG;AACV,6BAA6B;IACzBC,IAAI,EAAE;EACR,CAAC;;EAEDmB,gBAAgB,EAAE;IAChBpB,GAAG,EAAG,sBAAqB;IAC3BC,IAAI,EAAE;EACR,CAAC;EACDoB,gBAAgB,EAAE;IAChBrB,GAAG,EAAG,wBAAuB;IAC7BC,IAAI,EAAE;EACR,CAAC;EACDqB,gBAAgB,EAAE;IAChBtB,GAAG,EAAG,2BAA0B;IAChCC,IAAI,EAAE;EACR,CAAC;;EAEDsB,aAAa,EAAE;IACbvB,GAAG,EAAG;AACV;AACA,iCAAiC;IAC7BC,IAAI,EAAE;EACR,CAAC;;EAED;EACAuB,qBAAqB,EAAE;IACrBxB,GAAG,EAAG,wBAAuB;IAC7BC,IAAI,EAAE;EACR,CAAC;EACDwB,uBAAuB,EAAE;IACvBzB,GAAG,EAAG,wBAAuB;IAC7BC,IAAI,EAAE;EACR,CAAC;EACD;EACAyB,qBAAqB,EAAE;IACrB1B,GAAG,EAAG,6BAA4B;IAClCC,IAAI,EAAE;EACR,CAAC;;EAED0B,MAAM,EAAE;IACN3B,GAAG,EAAG,oBAAmB;IACzBC,IAAI,EAAE;EACR,CAAC;EACD2B,MAAM,EAAE;IACN5B,GAAG,EAAG,uBAAsB;IAC5BC,IAAI,EAAE;EACR,CAAC;EACD4B,MAAM,EAAE;IACN7B,GAAG,EAAG,0BAAyB;IAC/BC,IAAI,EAAE;EACR,CAAC;EACD6B,UAAU,EAAE;IACV9B,GAAG,EAAG,qBAAoB;IAC1BC,IAAI,EAAE;EACR,CAAC;EACD8B,UAAU,EAAE;IACV/B,GAAG,EAAG,wBAAuB;IAC7BC,IAAI,EAAE;EACR,CAAC;EACD+B,UAAU,EAAE;IACVhC,GAAG,EAAG,2BAA0B;IAChCC,IAAI,EAAE;EACR,CAAC;;EAEDgC,UAAU,EAAE;IACVjC,GAAG,EAAG,+BAA8B;IACpCC,IAAI,EAAE;EACR;AACF,CAAC;AACDJ,CAAC,CAACqC,IAAI,CAAC,gBAAgB,CAAC;AACrBC,IAAI,CAAE,mCAAkC,CAAC;AACzCC,MAAM,CAAC,CAAAC,CAAC,KAAIA,CAAC,CAACC,OAAO,CAAC,MAAM,EAAE3C,MAAM,CAACG,mBAAmB,CAAC,CAAC,CAAC;AAC3DyC,EAAE,CAAC,CAAAC,CAAC,KAAI;EACP,MAAMC,IAAI,GAAI;AAClB,EAAE3C,mBAAmB,CAAC0C,CAAC,CAACJ,MAAM,CAACM,IAAI,CAAC,CAAC1C,GAAI;AACzC,sBAAsB;EAClBwC,CAAC,CAACG,mBAAmB,CAAC7C,mBAAmB,CAAC0C,CAAC,CAACJ,MAAM,CAACM,IAAI,CAAC,CAACzC,IAAI,EAAEwC,IAAI,CAAC;AACtE,CAAC,CAAC"}